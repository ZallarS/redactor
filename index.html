<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–†–µ–¥–∞–∫—Ç–æ—Ä –∫–∞—Ä—Ç –¥–ª—è GTA-–ø–æ–¥–æ–±–Ω–æ–π –∏–≥—Ä—ã</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="container">
  <!-- –ü–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ -->
  <div class="toolbar">
    <div class="toolbar-sections">
      <section class="section">
        <h2>–ü–∞–ª–∏—Ç—Ä–∞ —Ç–∞–π–ª–æ–≤</h2>
        <div class="tile-palette" id="tilePalette"></div>
      </section>

      <section class="section">
        <h2>–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</h2>
        <div class="transport-controls">
          <button id="rotateLeft" title="–ü–æ–≤–µ—Ä–Ω—É—Ç—å –Ω–∞–ª–µ–≤–æ">‚Ü∂</button>
          <select id="transportDirection" title="–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞">
            <option value="0">–í–≤–µ—Ä—Ö</option>
            <option value="1">–í–ø—Ä–∞–≤–æ</option>
            <option value="2">–í–Ω–∏–∑</option>
            <option value="3">–í–ª–µ–≤–æ</option>
          </select>
          <button id="rotateRight" title="–ü–æ–≤–µ—Ä–Ω—É—Ç—å –Ω–∞–ø—Ä–∞–≤–æ">‚Ü∑</button>
        </div>
        <div class="transport-palette" id="transportPalette"></div>
      </section>

      <section class="section">
        <h2>–¢—Ä–∏–≥–≥–µ—Ä—ã</h2>
        <div class="triggers-palette" id="triggersPalette"></div>
      </section>

      <section class="section">
        <h2>–°—Ç—Ä—É–∫—Ç—É—Ä—ã</h2>
        <div class="structures-palette" id="structuresPalette"></div>
      </section>

      <section class="section">
        <h2>NPC</h2>
        <div class="npc-palette" id="npcPalette"></div>
      </section>

      <section class="section">
        <h2>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h2>
        <div class="tools">
          <button id="brush" class="active" title="–ö–∏—Å—Ç—å (Ctrl+B)">–ö–∏—Å—Ç—å</button>
          <button id="fill" title="–ó–∞–ª–∏–≤–∫–∞ (Ctrl+F)">–ó–∞–ª–∏–≤–∫–∞</button>
          <button id="erase" title="–õ–∞—Å—Ç–∏–∫ (Ctrl+E)">–õ–∞—Å—Ç–∏–∫</button>
          <button id="structure" title="–°—Ç—Ä—É–∫—Ç—É—Ä—ã (Ctrl+S)">–°—Ç—Ä—É–∫—Ç—É—Ä—ã</button>
          <button id="transport" title="–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç (Ctrl+T)">–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç</button>
          <button id="npc" title="NPC (Ctrl+N)">NPC</button>
          <button id="select" title="–í—ã–¥–µ–ª–µ–Ω–∏–µ (Ctrl+G)">–í—ã–¥–µ–ª–µ–Ω–∏–µ</button>
          <button id="missions" title="–†–µ–¥–∞–∫—Ç–æ—Ä –º–∏—Å—Å–∏–π (Ctrl+M)">–ú–∏—Å—Å–∏–∏</button>
          <button id="runGame" title="–ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã (Ctrl+R)">–ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã</button>
        </div>

        <div class="file-controls">
          <input type="file" id="loadMap" accept=".json" style="display: none;">
          <button id="loadMapBtn">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–∞—Ä—Ç—É</button>
          <button id="saveMap">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞—Ä—Ç—É</button>
          <button id="exportImage">–≠–∫—Å–ø–æ—Ä—Ç –≤ PNG</button>
          <button id="exportGame">–≠–∫—Å–ø–æ—Ä—Ç –¥–ª—è –∏–≥—Ä—ã</button>
        </div>

        <div class="map-info">
          <h3>–†–∞–∑–º–µ—Ä –∫–∞—Ä—Ç—ã</h3>
          <div class="size-controls">
            <div>
              <label>–®–∏—Ä–∏–Ω–∞:</label>
              <input type="number" id="width" value="50" min="10" max="200">
            </div>
            <div>
              <label>–í—ã—Å–æ—Ç–∞:</label>
              <input type="number" id="height" value="50" min="10" max="200">
            </div>
            <button id="resize">–ò–∑–º–µ–Ω–∏—Ç—å</button>
          </div>
        </div>

        <div class="selected-info" id="selectedInfo">
          <h3>–í—ã–±—Ä–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç</h3>
          <div id="objectInfo">–ù–µ—Ç</div>
          <div id="missionInfo" style="margin-top: 8px; display: none;"></div>
          <button id="editMissionBtn" style="margin-top: 8px; display: none;">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∏—Å—Å–∏—é</button>
        </div>

        <div class="preview-settings">
          <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞</h3>
          <label>
            <input type="checkbox" id="showPreview" checked>
            –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
          </label>
          <div class="preview-opacity">
            <label>–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å:</label>
            <input type="range" id="previewOpacity" min="10" max="90" value="60">
            <span id="opacityValue">60%</span>
          </div>
        </div>
      </section>
    </div>
  </div>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–µ –ø–æ–ª–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ -->
  <div class="editor-area">
    <div class="canvas-container">
      <canvas id="mapCanvas"></canvas>
      <canvas id="selectionCanvas"></canvas>
      <canvas id="gridCanvas"></canvas>
      <!-- Canvas –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
    </div>
    <div class="status-bar">
      <div class="coordinates" id="coordinates">X: 0, Y: 0</div>
      <div class="tool-info" id="toolInfo">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: –ö–∏—Å—Ç—å</div>
      <div class="selection-info" id="selectionInfo">–í—ã–¥–µ–ª–µ–Ω–æ: 0 –æ–±—ä–µ–∫—Ç–æ–≤</div>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –º–∏—Å—Å–∏–π -->
<div id="missionEditorModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>–†–µ–¥–∞–∫—Ç–æ—Ä –º–∏—Å—Å–∏–π –∏ –∫–≤–µ—Å—Ç–æ–≤</h2>
      <button class="close-modal">&times;</button>
    </div>
    <div class="modal-body">
      <div class="mission-editor-container">
        <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å: —Å–ø–∏—Å–æ–∫ –º–∏—Å—Å–∏–π -->
        <div class="missions-list">
          <div class="missions-header">
            <h3>–ú–∏—Å—Å–∏–∏</h3>
            <button id="newMissionBtn" class="btn-primary">+ –ù–æ–≤–∞—è –º–∏—Å—Å–∏—è</button>
          </div>
          <div class="missions-container" id="missionsContainer">
            <!-- –°–ø–∏—Å–æ–∫ –º–∏—Å—Å–∏–π –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
          </div>
        </div>

        <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å: —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏—Å—Å–∏–∏ -->
        <div class="mission-edit">
          <div class="mission-basic-info">
            <h3>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
            <div class="form-group">
              <label>ID –º–∏—Å—Å–∏–∏:</label>
              <input type="text" id="missionId" readonly>
            </div>
            <div class="form-group">
              <label>–ù–∞–∑–≤–∞–Ω–∏–µ –º–∏—Å—Å–∏–∏:</label>
              <input type="text" id="missionName" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–∏—Å—Å–∏–∏">
            </div>
            <div class="form-group">
              <label>–û–ø–∏—Å–∞–Ω–∏–µ:</label>
              <textarea id="missionDescription" rows="3" placeholder="–û–ø–∏—à–∏—Ç–µ –º–∏—Å—Å–∏—é –¥–ª—è –∏–≥—Ä–æ–∫–∞"></textarea>
            </div>
            <div class="form-group">
              <label>–¢–∏–ø –º–∏—Å—Å–∏–∏:</label>
              <select id="missionType">
                <option value="trigger">–¢—Ä–∏–≥–≥–µ—Ä –∞–∫—Ç–∏–≤–∞—Ü–∏–∏</option>
                <option value="collection">–°–±–æ—Ä –ø—Ä–µ–¥–º–µ—Ç–æ–≤</option>
                <option value="delivery">–î–æ—Å—Ç–∞–≤–∫–∞</option>
                <option value="elimination">–£–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ</option>
                <option value="escort">–≠—Å–∫–æ—Ä—Ç</option>
                <option value="race">–ì–æ–Ω–∫–∞</option>
                <option value="map_transition">–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –∫–∞—Ä—Ç—É</option>
                <option value="dialog">–î–∏–∞–ª–æ–≥</option>
                <option value="combination">–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è</option>
              </select>
            </div>
            <div class="form-group">
              <label>–°–ª–æ–∂–Ω–æ—Å—Ç—å:</label>
              <select id="missionDifficulty">
                <option value="easy">–õ–µ–≥–∫–∞—è</option>
                <option value="normal">–°—Ä–µ–¥–Ω—è—è</option>
                <option value="hard">–°–ª–æ–∂–Ω–∞—è</option>
                <option value="very_hard">–û—á–µ–Ω—å —Å–ª–æ–∂–Ω–∞—è</option>
              </select>
            </div>
            <div class="form-group">
              <label>–í—Ä–µ–º—è –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (—Å–µ–∫):</label>
              <input type="number" id="missionTimeLimit" min="0" value="0">
              <small>0 = –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏</small>
            </div>
          </div>

          <div class="mission-triggers">
            <h3>–¢—Ä–∏–≥–≥–µ—Ä—ã –º–∏—Å—Å–∏–∏</h3>
            <div class="form-group">
              <label>–¢—Ä–∏–≥–≥–µ—Ä –Ω–∞—á–∞–ª–∞:</label>
              <select id="missionStartTrigger">
                <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–∏–≥–≥–µ—Ä --</option>
              </select>
              <button id="selectStartTriggerBtn" class="btn-small">–í—ã–±—Ä–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ</button>
            </div>
            <div class="form-group" id="missionTargetTriggersGroup">
              <label>–¶–µ–ª–µ–≤—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã:</label>
              <div id="missionTargetTriggersList"></div>
              <button id="addTargetTriggerBtn" class="btn-small">+ –î–æ–±–∞–≤–∏—Ç—å —Ü–µ–ª—å</button>
            </div>
            <div class="form-group" id="missionEndTriggerGroup">
              <label>–¢—Ä–∏–≥–≥–µ—Ä –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:</label>
              <select id="missionEndTrigger">
                <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–∏–≥–≥–µ—Ä --</option>
              </select>
              <button id="selectEndTriggerBtn" class="btn-small">–í—ã–±—Ä–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ</button>
            </div>
          </div>

          <div class="mission-objectives">
            <h3>–¶–µ–ª–∏ –º–∏—Å—Å–∏–∏</h3>
            <div id="missionObjectivesContainer">
              <div class="objective-item" data-type="trigger">
                <div class="objective-header">
                  <span>üìå –¢—Ä–∏–≥–≥–µ—Ä –∞–∫—Ç–∏–≤–∞—Ü–∏–∏</span>
                  <button class="remove-objective">&times;</button>
                </div>
                <div class="objective-content">
                  <p>–ò–≥—Ä–æ–∫ –¥–æ–ª–∂–µ–Ω –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä</p>
                </div>
              </div>
            </div>
            <button id="addObjectiveBtn" class="btn-small">+ –î–æ–±–∞–≤–∏—Ç—å —Ü–µ–ª—å</button>
          </div>

          <div class="mission-rewards">
            <h3>–ù–∞–≥—Ä–∞–¥—ã</h3>
            <div class="form-group">
              <label>–û–ø—ã—Ç:</label>
              <input type="number" id="missionExpReward" min="0" value="100">
            </div>
            <div class="form-group">
              <label>–î–µ–Ω—å–≥–∏:</label>
              <input type="number" id="missionMoneyReward" min="0" value="500">
            </div>
            <div class="form-group">
              <label>–ü—Ä–µ–¥–º–µ—Ç—ã:</label>
              <div id="missionItemsRewardList"></div>
              <button id="addItemRewardBtn" class="btn-small">+ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç</button>
            </div>
            <div class="form-group">
              <label>–†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç:</label>
              <input type="text" id="missionUnlocks" placeholder="ID –Ω–æ–≤–æ–π –º–∏—Å—Å–∏–∏, –æ—Ä—É–∂–∏—è –∏ —Ç.–¥.">
            </div>
          </div>

          <div class="mission-dialogs" id="missionDialogsSection">
            <h3>–î–∏–∞–ª–æ–≥–∏</h3>
            <div id="missionDialogsList"></div>
            <button id="addDialogBtn" class="btn-small">+ –î–æ–±–∞–≤–∏—Ç—å –¥–∏–∞–ª–æ–≥</button>
          </div>

          <div class="mission-map-transition" id="missionMapTransitionSection">
            <h3>–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –∫–∞—Ä—Ç—É</h3>
            <div class="form-group">
              <label>–§–∞–π–ª –∫–∞—Ä—Ç—ã:</label>
              <input type="text" id="missionTargetMap" placeholder="maps/house.json">
              <button id="browseMapBtn" class="btn-small">–û–±–∑–æ—Ä</button>
            </div>
            <div class="form-group">
              <label>–¢—Ä–∏–≥–≥–µ—Ä —Å–ø–∞–≤–Ω–∞ –Ω–∞ –Ω–æ–≤–æ–π –∫–∞—Ä—Ç–µ:</label>
              <input type="text" id="missionSpawnTrigger" placeholder="ID —Ç—Ä–∏–≥–≥–µ—Ä–∞ —Å–ø–∞–≤–Ω–∞">
            </div>
            <div class="form-group">
              <label>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å:</label>
              <input type="checkbox" id="missionKeepInventory" checked>
            </div>
          </div>

          <div class="mission-controls">
            <button id="saveMissionBtn" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–∏—Å—Å–∏—é</button>
            <button id="deleteMissionBtn" class="btn-danger">–£–¥–∞–ª–∏—Ç—å –º–∏—Å—Å–∏—é</button>
            <button id="testMissionBtn" class="btn-secondary">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∏—Å—Å–∏—é</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–∏–∞–ª–æ–≥–∞ -->
<div id="dialogEditorModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>–†–µ–¥–∞–∫—Ç–æ—Ä –¥–∏–∞–ª–æ–≥–∞</h2>
      <button class="close-modal">&times;</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label>–ü–µ—Ä—Å–æ–Ω–∞–∂:</label>
        <input type="text" id="dialogCharacter" placeholder="–ò–º—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞">
      </div>
      <div class="form-group">
        <label>–¢–µ–∫—Å—Ç –¥–∏–∞–ª–æ–≥–∞:</label>
        <textarea id="dialogText" rows="4" placeholder="–¢–µ–∫—Å—Ç –¥–∏–∞–ª–æ–≥–∞"></textarea>
      </div>
      <div class="form-group">
        <label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞:</label>
        <input type="text" id="dialogImage" placeholder="images/npc.png">
      </div>
      <div class="form-group">
        <label>–í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤:</label>
        <div id="dialogOptionsList"></div>
        <button id="addDialogOptionBtn" class="btn-small">+ –î–æ–±–∞–≤–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç</button>
      </div>
      <div class="form-group">
        <label>–¢—Ä–∏–≥–≥–µ—Ä –ø–æ—Å–ª–µ –¥–∏–∞–ª–æ–≥–∞:</label>
        <select id="dialogTrigger">
          <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–∏–≥–≥–µ—Ä --</option>
        </select>
      </div>
      <div class="form-group">
        <label>–°–ª–µ–¥—É—é—â–∏–π –¥–∏–∞–ª–æ–≥:</label>
        <input type="text" id="dialogNext" placeholder="ID —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–∏–∞–ª–æ–≥–∞">
      </div>
      <div class="dialog-controls">
        <button id="saveDialogBtn" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∏–∞–ª–æ–≥</button>
        <button id="cancelDialogBtn" class="btn-secondary">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–µ–¥–º–µ—Ç–∞ -->
<div id="itemEditorModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>–†–µ–¥–∞–∫—Ç–æ—Ä –ø—Ä–µ–¥–º–µ—Ç–∞</h2>
      <button class="close-modal">&times;</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label>–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞:</label>
        <input type="text" id="itemName" placeholder="–ò–º—è –ø—Ä–µ–¥–º–µ—Ç–∞">
      </div>
      <div class="form-group">
        <label>–¢–∏–ø –ø—Ä–µ–¥–º–µ—Ç–∞:</label>
        <select id="itemType">
          <option value="weapon">–û—Ä—É–∂–∏–µ</option>
          <option value="ammo">–ü–∞—Ç—Ä–æ–Ω—ã</option>
          <option value="health">–ó–¥–æ—Ä–æ–≤—å–µ</option>
          <option value="armor">–ë—Ä–æ–Ω—è</option>
          <option value="key">–ö–ª—é—á</option>
          <option value="document">–î–æ–∫—É–º–µ–Ω—Ç</option>
          <option value="collectible">–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç</option>
          <option value="money">–î–µ–Ω—å–≥–∏</option>
        </select>
      </div>
      <div class="form-group">
        <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label>
        <input type="number" id="itemQuantity" min="1" value="1">
      </div>
      <div class="form-group">
        <label>–ó–Ω–∞—á–µ–Ω–∏–µ (–¥–ª—è –æ—Ä—É–∂–∏—è - —É—Ä–æ–Ω):</label>
        <input type="number" id="itemValue" min="0" value="0">
      </div>
      <div class="form-group">
        <label>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:</label>
        <input type="text" id="itemImage" placeholder="images/item.png">
      </div>
      <div class="form-group">
        <label>–û–ø–∏—Å–∞–Ω–∏–µ:</label>
        <textarea id="itemDescription" rows="2" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–∞"></textarea>
      </div>
      <div class="item-controls">
        <button id="saveItemBtn" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç</button>
        <button id="cancelItemBtn" class="btn-secondary">–û—Ç–º–µ–Ω–∞</button>
      </div>
    </div>
  </div>
</div>

<script src="script.js"></script>
</body>
</html>